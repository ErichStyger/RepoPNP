var localPath=window.location.pathname.indexOf("Mouser_Web")>0?"/Mouser_Web/":"/";var currentPath="https://"+window.location.hostname+"/";var isIE=false;var isSafari=false;if($.browser.msie){isIE=true}function ClosePopup(){$("div[id$=VisualAttributePopup]").dialog("close");dialog_remove()}function Item(b){var a=this;this.AttributeValueImage=ko.observable();this.AttributeValue=ko.observable("");this.AttributeDesc=ko.observable("");this.AttributeValueID=ko.observable(0);this.IsSelected=ko.observable(false);this.ImagePath1=ko.observable();
this.ImagePath2=ko.observable();this.ImagePath3=ko.observable();this.NoImageMsg=ko.observable("");this.RelatedImgFound=ko.observable(false);if(typeof(b)==="object"){this.AttributeValueImage=b.AttributeValueImage;this.AttributeValue=b.AttributeValue;this.AttributeDesc=b.AttributeDesc;this.AttributeValueID=b.AttributeValueID;this.IsSelected=b.IsSelected;this.ImagePath1=b.ImagePath1;this.ImagePath2=b.ImagePath2;this.ImagePath3=b.ImagePath3;this.NoImageMsg=b.NoImageMsg;this.RelatedImgFound=b.RelatedImgFound}}function DisplayAttributesModel(){var a=this;
a.AttributeGroupDescription=ko.observable("");a.hasGroupDescription=ko.observable(true);a.AttributeGroupID=0;a.attributes=ko.observableArray([]);a.attValueList=ko.observableArray([]);a.selectedValues=ko.observableArray([]);a.loadFinished=ko.observable(false);a.selectedAttributes=ko.observableArray([]);a.optionCount=ko.observable(0);a.listIndex=ko.observable(0);a.attValueIds=ko.observableArray([]);a.templateId=ko.observable(0);a.attributeGroupID=ko.observable(0);a.cultureCode=ko.observable("");a.displayType=ko.observable(0);
a.moreLoadFinished=ko.observable(true);a.hasMoreOptions=ko.observable(false);a.toggleSelection=function(c){c.IsSelected=(!c.IsSelected);if(c.IsSelected){if(jQuery.inArray(""+c.AttributeValueID+"",a.selectedAttributes())<0){a.selectedAttributes.push(""+c.AttributeValueID+"")}}else{a.selectedValues.splice(jQuery.inArray(""+c.AttributeValueID+"",a.selectedValues()),1);if(jQuery.inArray(""+c.AttributeValueID+"",a.selectedAttributes())>-1){a.selectedAttributes.splice(jQuery.inArray(""+c.AttributeValueID+"",a.selectedAttributes()),1)
}}var b=new Item({AttributeValueImage:c.AttributeValueImage,AttributeValue:c.AttributeValue,AttributeDesc:c.AttributeDesc,AttributeValueID:c.AttributeValueID,IsSelected:c.IsSelected,ImagePath1:c.ImagePath1,ImagePath2:c.ImagePath2,ImagePath3:c.ImagePath3,NoImageMsg:c.NoImageMsg,RelatedImgFound:c.RelatedImgFound});a.attributes.replace(c,b)};a.showMore=function(){a.moreLoadFinished(false);a.attValueIds.removeAll();var c=a.optionCount()-a.listIndex()<visualAttributeBatchCount?a.optionCount()-a.listIndex():visualAttributeBatchCount;
var d=document.getElementById($("select[id$="+a.attributeGroupID()+"]").attr("id"));for(var b=a.listIndex();b<(c+a.listIndex());b++){a.attValueIds.push(d.options[b].value+"||"+d.options[b].text)}a.listIndex(a.listIndex()+c);a.loadDataFromSQL(a.templateId(),a.attributeGroupID(),a.displayType(),a.cultureCode());a.hasMoreOptions(a.listIndex()<a.optionCount())};a.loadData=function(b,k,g,c,d){a.selectedValues.removeAll();a.attributes.removeAll();a.loadFinished(false);a.attValueIds.removeAll();a.templateId=ko.observable(b);
a.attributeGroupID=ko.observable(k);a.cultureCode=ko.observable(c);a.displayType=ko.observable(g);a.listIndex=ko.observable(0);a.moreLoadFinished(true);a.selectedAttributes.removeAll();a.hasGroupDescription(false);var l=GetCurrentSelectedValues(k);if(l.length>0){for(var h=0;h<l.length;h++){a.selectedValues.push(l[h])}}$("#VisualAttributePopup").dialog({autoOpen:false,modal:true,show:"blind",hide:"blind",title:d,width:450,height:"auto",maxHeight:475,close:function(i,m){dialog_remove()},create:function(i,n){var m=$(this).dialog("widget");
$(".ui-dialog-titlebar-close span",m).css({background:'url("/images/sprite_icon.png") no-repeat scroll 0 -104px transparent',width:"13px"});$(".ui-button-text",m).css({background:"none"});$(".ui-dialog-titlebar-close",m).attr("title","Close Window")}});$("div[id$=VisualAttributePopup]").dialog("open");HideBackgroundWhenPopupOpened();var f=document.getElementById($("select[id$="+k+"]").attr("id"));a.optionCount(f.options.length);var e=a.optionCount()-a.listIndex()<visualAttributeBatchCount?a.optionCount()-a.listIndex():visualAttributeBatchCount;
for(var j=a.listIndex();j<e;j++){a.attValueIds.push(f.options[j].value+"||"+f.options[j].text)}a.listIndex(a.listIndex()+e);a.loadDataFromSQL(b,k,g,c);a.hasMoreOptions(a.listIndex()<a.optionCount())};a.loadDataFromSQL=function(d,f,c,b){var e="";$.each(a.attValueIds(),function(g,h){e+=h+"|||"});$.ajax({url:localPath+"ajax/GetVisualParametrics.ashx",timeout:60000,data:"templateID="+d+"&groupID="+f+"&displayType="+c+"&culturecode="+b+"&action=2&attIDList="+e+"&paramList="+GetParamsFromUrl(),complete:function(){a.loadFinished(true);
a.moreLoadFinished(true);DisableAttributeValues(f)},success:function(g){if(g!=""){a.AttributeGroupID=f;a.hasGroupDescription(true);a.AttributeGroupDescription(g.AttributeGroupDescription);if(g.AttributeGroupDescription==""){a.hasGroupDescription(false)}if(g.Attributes!=null&&g.Attributes!=""){$.each(g.Attributes,function(i,j){var h=false;if(jQuery.inArray(""+j.AttributeValueID+"",a.selectedValues())>-1){h=true}a.attributes.push(new Item({AttributeValueImage:(typeof(j.AttributeValueImage)==="undefined"||j.AttributeValueImage==null)?null:j.AttributeValueImage,AttributeValue:j.AttributeValue,AttributeDesc:j.AttributeDesc,AttributeValueID:j.AttributeValueID,IsSelected:h,ImagePath1:(typeof(j.ImagePath1)==="undefined"||j.ImagePath1==null)?null:currentPath+j.ImagePath1,ImagePath2:(typeof(j.ImagePath2)==="undefined"||j.ImagePath2==null)?null:currentPath+j.ImagePath2,ImagePath3:(typeof(j.ImagePath3)==="undefined"||j.ImagePath3==null)?null:currentPath+j.ImagePath3,NoImageMsg:j.NoImageMsg,RelatedImgFound:j.RelatedImgFound}))
})}}else{a.loadFinished(true);a.moreLoadFinished(true)}}})};a.applySelections=function(){var b=a.AttributeGroupID;var d=document.getElementById($("select[id$="+b+"]").attr("id"));if(a.selectedAttributes().length>0){for(var c=0;c<d.options.length;c++){if(jQuery.inArray(""+d.options[c].value+"",a.selectedAttributes())>-1&&d.options[c].className!="disabled"){d.options[c].selected=true}else{if(jQuery.inArray(""+d.options[c].value+"",a.selectedValues())>-1&&d.options[c].className!="disabled"){d.options[c].selected=true
}else{d.options[c].selected=false}}}}else{if(a.selectedValues().length>0){for(var c=0;c<d.options.length;c++){if(jQuery.inArray(""+d.options[c].value+"",a.selectedValues())>-1&&d.options[c].className!="disabled"){d.options[c].selected=true}else{d.options[c].selected=false}}}else{$("select[id$="+b+"] option").attr("selected",false)}}ajaxCount(false);$("div[id$=VisualAttributePopup]").dialog("close");dialog_remove()}}function GetCurrentSelectedValues(a){var b=[];$("select[id$="+a+"] :selected").each(function(){b.push($(this).attr("value"))
});return b}function DisableAttributeValues(a){$("select[id$="+a+"] option[class=disabled]").each(function(b,c){if(isIE){if(parseInt($.browser.version.charAt(0))>=9){$("tr[attValueId="+c.value+"] td").attr("disabled",true).addClass("disabled").click(false)}else{$("tr[attValueId="+c.value+"]").attr("disabled",true).addClass("disabled")}}else{$("tr[attValueId="+c.value+"] td").attr("disabled",true).addClass("disabled").click(false).css("opacity","0.4")}})}function GetParamsFromUrl(){var c="";var b=jQuery.url.attr("path");
var a=b.split("/_/");if(a.length==2){c=c+"&seoN="+a[1]}if(jQuery.url.param("N")!=undefined){c=c+jQuery.url.param("N")}if(jQuery.url.param("P")!=undefined){c=c+"&P="+jQuery.url.param("P")}if(jQuery.url.param("Mfr")!=undefined&&jQuery.url.param("Ps")==undefined){c=c+"&Mfr="+jQuery.url.param("Mfr")}if(jQuery.url.param("Nr")!=undefined){c=c+"&Nr="+jQuery.url.param("Nr")}if(jQuery.url.param("keyword")!=undefined){if(jQuery.url.param("TrdTerm")!=undefined){c=c+"&Ntt="+jQuery.url.param("TrdTerm")}else{c=c+"&Ntt="+jQuery.url.param("keyword")
}}else{if(jQuery.url.param("Keyword")!=undefined){if(jQuery.url.param("TrdTerm")!=undefined){c=c+"&Ntt="+jQuery.url.param("TrdTerm")}else{c=c+"&Ntt="+jQuery.url.param("Keyword")}}else{if(jQuery.url.param("Ntt")!=undefined){if(jQuery.url.param("TrdTerm")!=undefined){c=c+"&Ntt="+jQuery.url.param("TrdTerm")}else{c=c+"&Ntt="+jQuery.url.param("Ntt")}}}}return c}function HideBackgroundWhenPopupOpened(){if(document.getElementById("Dialog_overlay")===null){$("body form:first").append("<div id='Dialog_overlay'></div><div id='Dialog_window'></div>");
$("#Dialog_overlay").click(dialog_remove)}if(tb_detectMacXFF()){$("#Dialog_overlay").addClass("Dialog_overlayMacFFBGHack")}else{$("#Dialog_overlay").addClass("Dialog_overlayBG")}}function dialog_remove(){$("#Dialog_overlay").remove();return false}function tb_detectMacXFF(){var a=navigator.userAgent.toLowerCase();if(a.indexOf("mac")!=-1&&a.indexOf("firefox")!=-1){return true}return false};